<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<html lang="en">
<head th:replace="fragments/header :: header">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<h1>토론방</h1>

<!-- 토론 방 정보 -->
<div th:object="${debateRoomResponseDto}">
    <div th:text="|카테고리 : *{category}|"></div>
    <div th:text="|주제 : *{topic}|"></div>
    <div th:text="|방제 : *{title}|"></div>
    <div th:text="|방장 : *{owner}|"></div>

    <h1>찬성</h1>
    <div id="pros-name" th:value="*{pros}" th:text="*{pros}"></div>
    <button id="pros-ready" th:text="*{prosReady}" th:onclick="setProsReady([[${debateRoomId}]])"></button>
    <button th:onclick="setPros([[${debateRoomId}]] ,[[${loginUsername}]],[[*{cons}]])">찬성 참여</button>

    <h1>반대</h1>
    <div id="cons-name" th:value="*{cons}" th:text="*{cons}"></div>
    <button id="cons-ready" th:text="*{consReady}" th:onclick="setConsReady([[${debateRoomId}]])"></button>
    <button th:onclick="setCons([[${debateRoomId}]] ,[[*{pros}]],[[${loginUsername}]])">반대 참여</button>

    <h1>구경꾼</h1>
    <div id="spector-list">
        <div th:each="spectorName : *{spectorsName}" th:text="${spectorName}"></div>
    </div>

    <button th:onclick="setSpectors([[${debateRoomId}]] ,[[*{pros}]], [[*{cons}]], [[${loginUsername}]])">구경꾼 참여</button>

    <div th:text="|발언시간 : *{speakingTime}|"></div>
    <div th:text="|토론시간 : *{discussionTime}|"></div>

    <button th:onclick="debateStart([[${debateRoomId}]], [[*{speakingTime}]], [[*{discussionTime}]])">시작</button>

    <div id="remaining-speaking-time"></div>
    <div id="remaining-debate-time"></div>

    <div th:text="|방 상태 : *{start}|"></div>

    <button th:if="*{owner} == ${loginUsername}" type="button" th:onclick="debateRoomDelete([[${debateRoomId}]])">방 깨기</button>
    <button th:unless="*{owner} == ${loginUsername}" type="button" th:onclick="debateRoomExit([[${loginUserId}]], [[${debateRoomId}]])">나가기</button>
</div>

<input id="debateroom-id" type="hidden" th:value="${debateRoomId}">
<input id="login-username" type="hidden" th:value="${loginUsername}">
<input id="login-userid" type="hidden" th:value="${loginUserId}">

<h1>발언</h1>
<div>
    <form id="speech-save-form">
        <input type="text" name="message">
        <button type="button" th:onclick="speech([[${debateRoomId}]], [[${loginUsername}]])">발언</button>
    </form>
</div>

<div id="speech-list">
    <div th:each="speech : ${speeches}" th:text="${speech.speech}"></div>
</div>

<h1>채팅</h1>
<div>
    <form id="chat-form">
        <input type="text" name="message">
        <button type="button" th:onclick="chat([[${debateRoomId}]], [[${loginUsername}]])">채팅</button>
    </form>
</div>

<div id="chat-list">
    <div th:each="chat : ${chats}" th:text="${chat.message}"></div>
</div>

<div th:replace="fragments/footer :: footer" />

<script src="/js/user-exit.js"></script>
<script src="/js/debateroom-position-update.js"></script>
<script src="/js/debateroom-ready-update.js"></script>
<script src="/js/debateroom-start-update.js"></script>
<script src="/js/debateroom-delete.js"></script>
<script src="/js/socket.js"></script>
<script src="/js/chat.js"></script>

</body>
</html>